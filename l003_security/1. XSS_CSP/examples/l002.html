<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <p>In this example we can see how attackers and perform unauthorized activities on behalf of you </p>
    <div>Welcome <span id="username"></span>!</div>

    <script>
        // suppose we have some cookies send by server to us, here for this example we are setting any values
        function setCookies(name, value, days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000)); // converting days to ms
            const expires = `expires=${date.toUTCString()}`;
            document.cookie = `${name}=${value};${expires};path=/`
        }
        setCookies("exampleCookie", "Hello World !", 7);

        // utility method
        function createPost(title, description) {
            // This method will post something on users profile
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/post", true);
            xhr.withCredentials = true; // will include cookies in request automatically
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send(`txtName=${title}&mtxMessage=${description}`); // will be send in body as paylod
        }

        // copy it and add as name search param in the url
        console.log(encodeURIComponent("<img src=\"does-not-exist\" onerror=\"createPost('HACK_TITLE','HACK_DESCRIPTION')\" />"));

        const params = new URLSearchParams(window.location.search); // get search params
        const name = params.get("name");
        document.getElementById("username").innerHTML = name;
    </script>
</body>

</html>